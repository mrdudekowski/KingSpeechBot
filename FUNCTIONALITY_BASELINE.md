# Эталонный функционал SimplePoll Bot

---

## 1. Основные возможности
- **Проведение опроса для подбора языкового курса**:
  - Многошаговый диалог с пользователем (выбор языка интерфейса, имя, язык обучения, уровень, цель, формат, ожидания, дата старта, телефон).
  - Поддержка русского и английского интерфейса.
  - Сохранение результатов опроса в Google Sheets.

- **Интерактивные кнопки и клавиатуры**:
  - Использование InlineKeyboard и ReplyKeyboard для удобства пользователя.
  - Кнопка для отправки номера телефона.

- **AI Tutor**:
  - Встроенный шаг с AI Tutor для проверки знаний, объяснений и помощи по английскому языку.
  - Лимит на количество обращений к AI Tutor для одного пользователя.

- **Управление статусом заявок**:
  - Возможность обновлять статус заявки через Telegram-интерфейс (для админов/менеджеров).
  - Синхронизация статусов с Google Sheets.

- **Многоразовый сценарий**:
  - Возможность начать опрос заново командой /trash.
  - Команда /help для получения справки.

---

## 2. Интеграции
- **Google Sheets**:
  - Добавление новых строк с результатами опроса.
  - Обновление статусов заявок.
  - Создание листа по месяцу, если он отсутствует.

- **Telegram Bot API**:
  - Обработка команд (/start, /help, /trash, /tutor).
  - Обработка текстовых сообщений, контактов, callback-запросов.

- **AI Tutor (через OpenRouter или аналогичный сервис)**:
  - Ответы на вопросы пользователя по английскому языку.
  - Проверка грамматики, переводов, объяснений.

---

## 3. Безопасность и устойчивость
- Валидация пользовательских данных (например, номера телефона).
- Логирование всех ключевых событий и ошибок.
- Обработка ошибок при работе с внешними сервисами (Google, Telegram, AI).

---

## 4. Тестирование
- Покрытие тестами всех основных сценариев (Google Sheets, удаление эмодзи, пользовательские сценарии, AI Tutor, админ-функции).
- Асинхронные и синхронные тесты.

---

## 5. Ограничения
- Бот работает только в режиме polling (webhook не используется).
- Для работы с Google Sheets требуется service-account.json.
- Для AI Tutor требуется ключ OpenRouter (или аналогичный).

---

**Это эталонное описание функционала SimplePoll Bot. Все будущие изменения должны соответствовать или расширять этот функционал без нарушения базовых возможностей.** 